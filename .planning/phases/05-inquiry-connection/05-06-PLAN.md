---
phase: 05-inquiry-connection
plan: 06
type: execute
wave: 3
depends_on: ["05-03", "05-04"]
files_modified:
  - frontend/src/components/dashboard/VendorInquiriesList.jsx
  - frontend/src/components/inquiry/InquiryStatsCards.jsx
  - frontend/src/pages/VendorDashboard.jsx
autonomous: true

must_haves:
  truths:
    - "Vendor can view list of received inquiries"
    - "Vendor can respond to pending inquiries (accept/decline)"
    - "Vendor dashboard shows inquiry statistics"
    - "Inquiries section appears in sidebar navigation"
  artifacts:
    - path: "frontend/src/components/dashboard/VendorInquiriesList.jsx"
      provides: "Vendor's received inquiries list"
      min_lines: 50
    - path: "frontend/src/components/inquiry/InquiryStatsCards.jsx"
      provides: "Stats cards for vendor overview"
      min_lines: 40
    - path: "frontend/src/pages/VendorDashboard.jsx"
      provides: "Dashboard with Inquiries section"
      contains: "VendorInquiriesList"
  key_links:
    - from: "VendorDashboard.jsx"
      to: "VendorInquiriesList.jsx"
      via: "import"
    - from: "VendorInquiriesList.jsx"
      to: "useInquiries.ts"
      via: "useVendorInquiries"
---

<objective>
Add Inquiries section to Vendor Dashboard with stats and response capability.

Purpose: Let vendors view, manage, and respond to received inquiries
Output: VendorDashboard with Inquiries section, stats cards, and response dialog
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-inquiry-connection/05-CONTEXT.md

Files to reference:
@frontend/src/pages/VendorDashboard.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create InquiryStatsCards component</name>
  <files>frontend/src/components/inquiry/InquiryStatsCards.jsx</files>
  <action>
Create stats cards component for vendor dashboard overview.

```jsx
import { useInquiryStats } from '../../hooks/useInquiries'
import { MessageSquare, Clock, CheckCircle, XCircle } from 'lucide-react'

export function InquiryStatsCards({ vendorId }) {
  const { data: stats } = useInquiryStats(vendorId)

  return (
    <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
      <StatCard
        icon={MessageSquare}
        iconBg="bg-[#0F4C5C]/10"
        iconColor="text-[#0F4C5C]"
        value={stats?.total || 0}
        label="Total"
      />
      <StatCard
        icon={Clock}
        iconBg="bg-amber-100"
        iconColor="text-amber-600"
        value={stats?.pending || 0}
        label="Pending"
      />
      <StatCard
        icon={CheckCircle}
        iconBg="bg-green-100"
        iconColor="text-green-600"
        value={stats?.accepted || 0}
        label="Accepted"
      />
      <StatCard
        icon={XCircle}
        iconBg="bg-red-100"
        iconColor="text-red-600"
        value={stats?.declined || 0}
        label="Declined"
      />
    </div>
  )
}

function StatCard({ icon: Icon, iconBg, iconColor, value, label }) {
  return (
    <div className="bg-white rounded-lg p-4 border shadow-sm">
      <div className="flex items-center gap-3">
        <div className={`w-10 h-10 rounded-lg ${iconBg} flex items-center justify-center`}>
          <Icon className={`w-5 h-5 ${iconColor}`} />
        </div>
        <div>
          <p className="text-2xl font-bold text-[#1A1A1A]">{value}</p>
          <p className="text-sm text-gray-500">{label}</p>
        </div>
      </div>
    </div>
  )
}
```
  </action>
  <verify>Component renders four stat cards with icons and values</verify>
  <done>InquiryStatsCards displays total, pending, accepted, declined counts</done>
</task>

<task type="auto">
  <name>Task 2: Create VendorInquiriesList component</name>
  <files>frontend/src/components/dashboard/VendorInquiriesList.jsx</files>
  <action>
Create vendor inquiries list with respond functionality.

```jsx
import { useState, useEffect } from 'react'
import { useVendorInquiries, useMarkInquiryRead } from '../../hooks/useInquiries'
import { InquiryCard } from '../inquiry/InquiryCard'
import { RespondInquiryDialog } from '../inquiry/RespondInquiryDialog'
import { Loader2, Inbox } from 'lucide-react'

export function VendorInquiriesList({ vendorId }) {
  const { data: inquiries = [], isLoading } = useVendorInquiries(vendorId)
  const markRead = useMarkInquiryRead('vendor')
  const [selectedInquiry, setSelectedInquiry] = useState(null)
  const [respondDialogOpen, setRespondDialogOpen] = useState(false)

  // Mark inquiries as read when viewing
  useEffect(() => {
    const unread = inquiries.filter(i => !i.vendor_read_at)
    unread.forEach(inquiry => {
      markRead.mutate(inquiry.id)
    })
  }, [inquiries])

  const handleRespond = (inquiry) => {
    setSelectedInquiry(inquiry)
    setRespondDialogOpen(true)
  }

  if (isLoading) {
    return (
      <div className="flex items-center justify-center py-8">
        <Loader2 className="w-6 h-6 animate-spin text-[#0F4C5C]" />
      </div>
    )
  }

  if (inquiries.length === 0) {
    return (
      <div className="bg-white rounded-xl p-8 shadow-sm text-center">
        <div className="w-12 h-12 rounded-full bg-[#F9F8F4] flex items-center justify-center mx-auto mb-3">
          <Inbox className="w-6 h-6 text-[#888888]" />
        </div>
        <h3 className="font-medium text-[#1A1A1A] mb-1">No inquiries yet</h3>
        <p className="text-sm text-[#888888]">
          When families send you inquiries, they'll appear here.
        </p>
      </div>
    )
  }

  return (
    <>
      <div className="space-y-4">
        {inquiries.map((inquiry) => (
          <InquiryCard
            key={inquiry.id}
            inquiry={inquiry}
            view="vendor"
            onRespond={() => handleRespond(inquiry)}
          />
        ))}
      </div>

      <RespondInquiryDialog
        inquiry={selectedInquiry}
        open={respondDialogOpen}
        onOpenChange={setRespondDialogOpen}
      />
    </>
  )
}
```
  </action>
  <verify>Component renders list with respond functionality and dialog</verify>
  <done>VendorInquiriesList displays inquiries with Respond button and dialog</done>
</task>

<task type="auto">
  <name>Task 3: Add Inquiries section to VendorDashboard</name>
  <files>frontend/src/pages/VendorDashboard.jsx</files>
  <action>
Add Inquiries section to VendorDashboard sidebar and content.

Changes:

1. Add imports:
```jsx
import { VendorInquiriesList } from "../components/dashboard/VendorInquiriesList"
import { InquiryStatsCards } from "../components/inquiry/InquiryStatsCards"
import { useUnreadCount } from "../hooks/useInquiries"
```

2. Add MessageSquare to lucide imports:
```jsx
import {
  Store, Calendar, MapPin, DollarSign, Edit2,
  Loader2, Star, LayoutDashboard, Image, ExternalLink,
  CheckCircle2, AlertCircle, ImageIcon, CalendarDays, MessageSquare
} from "lucide-react";
```

3. Add to sections array (after availability):
```jsx
const sections = [
  { id: 'overview', label: 'Overview', icon: LayoutDashboard },
  { id: 'profile', label: 'Profile', icon: Store },
  { id: 'portfolio', label: 'Portfolio', icon: Image },
  { id: 'availability', label: 'Availability', icon: Calendar },
  { id: 'inquiries', label: 'Inquiries', icon: MessageSquare },  // ADD THIS
];
```

4. Get unread count for badge (add near other hooks):
```jsx
const { data: unreadCount = 0 } = useUnreadCount(user?.id, 'vendor')
```

5. Add unread badge to sidebar button (optional enhancement):
In the sidebar nav button, add relative positioning and badge:
```jsx
<button
  key={section.id}
  onClick={() => setActiveSection(section.id)}
  className={cn(
    "relative w-full flex items-center gap-3 px-4 py-2 rounded-lg text-left transition-colors",
    activeSection === section.id
      ? "bg-[#0F4C5C] text-white"
      : "text-gray-600 hover:bg-gray-100"
  )}
>
  <section.icon className="w-5 h-5" />
  {section.label}
  {section.id === 'inquiries' && unreadCount > 0 && (
    <span className="absolute right-2 min-w-[20px] h-5 rounded-full bg-red-500 text-white text-xs flex items-center justify-center">
      {unreadCount > 9 ? '9+' : unreadCount}
    </span>
  )}
</button>
```

6. Add renderSection case for inquiries:
```jsx
case 'inquiries':
  return (
    <InquiriesSection vendorId={user?.id} />
  );
```

7. Create InquiriesSection component at bottom of file:
```jsx
function InquiriesSection({ vendorId }) {
  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-[#1A1A1A]" style={{ fontFamily: 'Playfair Display, serif' }}>
          Inquiries
        </h1>
        <p className="text-gray-500">
          View and respond to inquiries from families.
        </p>
      </div>

      {/* Stats Cards */}
      <InquiryStatsCards vendorId={vendorId} />

      {/* Inquiries List */}
      <div className="mt-6">
        <h3 className="font-medium text-[#1A1A1A] mb-4">All Inquiries</h3>
        <VendorInquiriesList vendorId={vendorId} />
      </div>
    </div>
  );
}
```

8. Add InquiryStatsCards to OverviewSection (Quick Stats grid):
Add after the existing 3 stat cards:
```jsx
{/* Inquiry stats in overview */}
<div className="bg-white rounded-lg p-4 border shadow-sm">
  <div className="flex items-center gap-3">
    <div className="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
      <MessageSquare className="w-5 h-5 text-blue-600" />
    </div>
    <div>
      <p className="text-2xl font-bold text-[#1A1A1A]">0</p>
      <p className="text-sm text-gray-500">Pending Inquiries</p>
    </div>
  </div>
</div>
```
(Note: Use useInquiryStats to get actual count)
  </action>
  <verify>
Check: VendorDashboard renders without errors
Check: "Inquiries" appears in sidebar
Check: Clicking Inquiries shows stats and list
Check: Respond dialog opens from InquiryCard
  </verify>
  <done>VendorDashboard has Inquiries section with stats, list, unread badge, and response capability</done>
</task>

</tasks>

<verification>
- [ ] InquiryStatsCards displays four stat cards
- [ ] VendorInquiriesList shows received inquiries
- [ ] VendorDashboard sidebar includes Inquiries section
- [ ] Unread badge shows on Inquiries nav item
- [ ] RespondInquiryDialog opens from Respond button
- [ ] Accept/Decline updates inquiry status
</verification>

<success_criteria>
Vendors can view, manage, and respond to inquiries from their dashboard. Stats provide at-a-glance overview.
</success_criteria>

<output>
After completion, create `.planning/phases/05-inquiry-connection/05-06-SUMMARY.md`
</output>
