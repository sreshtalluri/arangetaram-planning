---
phase: 02-vendor-supply-platform
plan: 06
type: execute
wave: 3
depends_on: ["02-04", "02-05"]
files_modified:
  - frontend/src/pages/VendorDashboard.jsx
autonomous: false

must_haves:
  truths:
    - "Vendor dashboard has sidebar navigation"
    - "Dashboard shows Overview, Profile, Portfolio, Availability sections"
    - "Vendor can edit profile from dashboard"
    - "Vendor can upload portfolio images from dashboard"
    - "Vendor can manage availability from dashboard"
    - "Incomplete profile shows completion prompt"
  artifacts:
    - path: "frontend/src/pages/VendorDashboard.jsx"
      provides: "Rebuilt vendor dashboard with sidebar navigation"
      min_lines: 200
  key_links:
    - from: "VendorDashboard.jsx"
      to: "useVendorProfile"
      via: "hook for profile data"
      pattern: "useVendorProfile"
    - from: "VendorDashboard.jsx"
      to: "PortfolioGallery"
      via: "component import"
      pattern: "PortfolioGallery"
    - from: "VendorDashboard.jsx"
      to: "AvailabilityCalendar"
      via: "component import"
      pattern: "AvailabilityCalendar"
---

<objective>
Rebuild VendorDashboard with sidebar navigation integrating all new components: profile editing, portfolio management, and availability calendar.

Purpose: Provides the unified vendor management experience combining all Phase 2 features.
Output: Complete vendor dashboard with Overview, Profile, Portfolio, and Availability sections.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-vendor-supply-platform/02-CONTEXT.md

@frontend/src/pages/VendorDashboard.jsx
@frontend/src/components/vendor/PortfolioUploader.tsx
@frontend/src/components/vendor/PortfolioGallery.tsx
@frontend/src/components/vendor/AvailabilityCalendar.tsx
@frontend/src/hooks/useVendorProfile.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild VendorDashboard with sidebar navigation</name>
  <files>frontend/src/pages/VendorDashboard.jsx</files>
  <action>
Refactor VendorDashboard.jsx to use sidebar navigation instead of tabs:

1. **Keep existing imports** that are still needed (Navbar, Button, Badge, icons, toast)

2. **Add new imports:**
```jsx
import { useVendorProfile, useUpdateVendorProfile } from '../hooks/useVendorProfile'
import { usePortfolio } from '../hooks/usePortfolio'
import { useAvailability } from '../hooks/useAvailability'
import { PortfolioUploader } from '../components/vendor/PortfolioUploader'
import { PortfolioGallery } from '../components/vendor/PortfolioGallery'
import { AvailabilityCalendar } from '../components/vendor/AvailabilityCalendar'
import { VENDOR_CATEGORIES, getCategoryByValue } from '../lib/vendor-categories'
```

3. **Replace data loading** with React Query hooks:
```jsx
const { user } = useAuth()
const { data: vendorProfile, isLoading: profileLoading } = useVendorProfile(user?.id)
const { data: portfolioImages = [] } = usePortfolio(user?.id)
const { data: availability = [] } = useAvailability(user?.id)
```

4. **Add sidebar navigation state:**
```jsx
const [activeSection, setActiveSection] = useState('overview')

const sections = [
  { id: 'overview', label: 'Overview', icon: LayoutDashboard },
  { id: 'profile', label: 'Profile', icon: Store },
  { id: 'portfolio', label: 'Portfolio', icon: Image },
  { id: 'availability', label: 'Availability', icon: Calendar },
]
```

5. **Create sidebar layout:**
```jsx
<div className="flex">
  {/* Sidebar */}
  <aside className="w-64 bg-white border-r min-h-[calc(100vh-64px)] p-4">
    <nav className="space-y-1">
      {sections.map((section) => (
        <button
          key={section.id}
          onClick={() => setActiveSection(section.id)}
          className={cn(
            "w-full flex items-center gap-3 px-4 py-2 rounded-lg text-left",
            activeSection === section.id
              ? "bg-[#0F4C5C] text-white"
              : "text-gray-600 hover:bg-gray-100"
          )}
        >
          <section.icon className="w-5 h-5" />
          {section.label}
        </button>
      ))}
    </nav>
  </aside>

  {/* Main content */}
  <main className="flex-1 p-6">
    {activeSection === 'overview' && <OverviewSection ... />}
    {activeSection === 'profile' && <ProfileSection ... />}
    {activeSection === 'portfolio' && <PortfolioSection ... />}
    {activeSection === 'availability' && <AvailabilitySection ... />}
  </main>
</div>
```

6. **Overview section** shows:
   - Profile completion status (if incomplete, show prompt to complete)
   - Quick stats: portfolio images count, blocked dates count
   - "View as User" button linking to public profile

7. **Profile section** shows:
   - Current profile info in read-only card
   - "Edit Profile" button that opens existing dialog or links to wizard
   - Link to create profile if none exists

8. **Portfolio section** shows:
   - PortfolioUploader component
   - PortfolioGallery component
   - Count: X/10 images

9. **Availability section** shows:
   - AvailabilityCalendar component
   - Summary of upcoming blocked dates

10. **Keep existing bookings functionality** but move to a "Bookings" tab (lower priority, can be added later in Phase 5)

11. **Remove legacy API calls** (vendorAPI, bookingAPI from api.js) - replace with Supabase hooks

12. **Handle no profile state:**
```jsx
if (!vendorProfile) {
  return (
    <div className="text-center py-12">
      <Store className="w-16 h-16 text-gray-300 mx-auto mb-4" />
      <h2 className="text-xl font-semibold mb-2">Create Your Profile</h2>
      <p className="text-gray-500 mb-4">
        Set up your vendor profile to start receiving inquiries
      </p>
      <Button onClick={() => navigate('/vendor/profile/create')}>
        Create Profile
      </Button>
    </div>
  )
}
```
  </action>
  <verify>
- VendorDashboard.jsx compiles without errors
- Sidebar shows Overview, Profile, Portfolio, Availability
- Clicking sidebar items switches content
- Profile section shows data from useVendorProfile
- Portfolio section shows PortfolioUploader and PortfolioGallery
- Availability section shows AvailabilityCalendar
  </verify>
  <done>
VendorDashboard rebuilt with sidebar navigation and integrated vendor components.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete vendor platform with:
1. Database schema (vendor_profiles, portfolio_images, vendor_availability)
2. Category definitions (11 Arangetram vendor categories)
3. Profile wizard with auto-save
4. Portfolio upload and drag-to-reorder
5. Availability calendar with date blocking
6. Rebuilt vendor dashboard with sidebar navigation
  </what-built>
  <how-to-verify>
1. **Create vendor account** (if not already):
   - Go to /vendor/signup
   - Register with vendor role

2. **Test profile wizard**:
   - Go to /vendor/profile/create
   - Fill in Step 1 (basics) and click Next
   - Refresh browser - data should persist
   - Complete all steps
   - Verify profile created in Supabase dashboard

3. **Test vendor dashboard**:
   - Go to /vendor/dashboard
   - Click through sidebar sections (Overview, Profile, Portfolio, Availability)
   - Verify profile info displays correctly

4. **Test portfolio upload**:
   - In Portfolio section, click to upload image
   - Verify preview appears
   - Click Upload
   - Verify image appears in gallery
   - Try drag-to-reorder (drag one image over another)
   - Verify order persists after refresh

5. **Test availability calendar**:
   - In Availability section, click future dates to select
   - Add optional note
   - Click "Mark as Booked"
   - Verify dates show red "Booked" styling
   - Click a red date to unblock
   - Verify date becomes available

6. **Test "View as User" preview** (if implemented):
   - Click button to see public vendor profile

**Expected outcomes:**
- Profile data persists in database
- Images upload to Supabase Storage
- Availability dates stored in vendor_availability table
- All UI interactions are smooth and responsive
  </how-to-verify>
  <resume-signal>Type "approved" if all features work, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. Vendor dashboard loads without errors
2. Sidebar navigation works
3. Profile section shows data from Supabase (not legacy API)
4. Portfolio section integrates uploader and gallery
5. Availability section integrates calendar
6. No profile state shows "Create Profile" prompt
</verification>

<success_criteria>
- VendorDashboard uses React Query hooks (not legacy API)
- All four sidebar sections render correctly
- PortfolioGallery shows images with drag-drop
- AvailabilityCalendar shows blocked dates
- User verification confirms full flow works
</success_criteria>

<output>
After completion, create `.planning/phases/02-vendor-supply-platform/02-06-SUMMARY.md`
</output>
