---
phase: 03-event-planning-discovery
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - frontend/src/components/event/EventWizard/index.tsx
  - frontend/src/components/event/EventWizard/StepDetails.tsx
  - frontend/src/components/event/EventWizard/StepCategories.tsx
  - frontend/src/components/event/EventWizard/StepReview.tsx
  - frontend/src/pages/CreateEventPage.tsx
  - frontend/src/App.js
autonomous: true

must_haves:
  truths:
    - "User can enter event name and date (required fields)"
    - "User can optionally enter location, guest count, budget"
    - "User can select needed categories from all 11 vendor categories"
    - "User can mark categories as already covered"
    - "Form auto-saves to localStorage on every change"
    - "Submitting creates event in database and redirects to dashboard"
  artifacts:
    - path: "frontend/src/components/event/EventWizard/index.tsx"
      provides: "Main wizard controller with FormProvider"
      min_lines: 80
    - path: "frontend/src/components/event/EventWizard/StepDetails.tsx"
      provides: "Event details form step"
      min_lines: 60
    - path: "frontend/src/components/event/EventWizard/StepCategories.tsx"
      provides: "Category selection step with covered toggle"
      min_lines: 80
    - path: "frontend/src/components/event/EventWizard/StepReview.tsx"
      provides: "Review and submit step"
      min_lines: 50
    - path: "frontend/src/pages/CreateEventPage.tsx"
      provides: "Page wrapper for wizard"
      min_lines: 30
  key_links:
    - from: "frontend/src/components/event/EventWizard/index.tsx"
      to: "frontend/src/hooks/useEvents.ts"
      via: "useCreateEvent mutation"
      pattern: "useCreateEvent"
    - from: "frontend/src/App.js"
      to: "frontend/src/pages/CreateEventPage.tsx"
      via: "Route path=/events/create"
      pattern: "path.*events/create"
---

<objective>
Create event creation wizard with 3-step flow: Details -> Categories -> Review.

Purpose: Enable users to create events specifying their Arangetram needs
Output: Multi-step wizard mirroring vendor ProfileWizard pattern, with auto-save and database persistence
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-event-planning-discovery/03-CONTEXT.md
@.planning/phases/03-event-planning-discovery/03-RESEARCH.md
@.planning/phases/03-event-planning-discovery/03-01-SUMMARY.md

# Pattern to follow closely
@frontend/src/components/vendor/ProfileWizard/index.tsx
@frontend/src/components/vendor/ProfileWizard/StepBasics.tsx
@frontend/src/components/vendor/ProfileWizard/StepCategory.tsx
@frontend/src/lib/vendor-categories.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EventWizard component suite</name>
  <files>
    frontend/src/components/event/EventWizard/index.tsx
    frontend/src/components/event/EventWizard/StepDetails.tsx
    frontend/src/components/event/EventWizard/StepCategories.tsx
    frontend/src/components/event/EventWizard/StepReview.tsx
  </files>
  <action>
Create EventWizard following ProfileWizard pattern exactly:

**index.tsx (main controller):**
- STORAGE_KEY = 'event-draft'
- STEPS = ['Details', 'Categories', 'Review']
- FormProvider wraps all steps
- Auto-save via methods.watch() to localStorage
- Load existing event data if editing (check URL param ?edit=eventId)
- On submit: call useCreateEvent or useUpdateEvent, clear localStorage, navigate to /dashboard
- useAuth for user context

**Form schema (use Zod):**
```typescript
const eventSchema = z.object({
  event_name: z.string().min(1, 'Event name is required'),
  event_date: z.string().min(1, 'Event date is required'), // yyyy-MM-dd
  location: z.string().optional(),
  guest_count: z.number().optional().nullable(),
  budget: z.number().optional().nullable(),
  categories_needed: z.array(z.string()).min(1, 'Select at least one category'),
  categories_covered: z.array(z.string()).default([]),
})
```

**StepDetails.tsx:**
- Event name input (required, text)
- Event date input (required, use react-day-picker Calendar in a Popover)
- Location select (optional, use METRO_AREAS from metro-areas.ts)
- Guest count input (optional, number)
- Budget input (optional, number with $ prefix)
- "Next" button validates required fields before proceeding
- Use useFormContext() to access form state

**StepCategories.tsx:**
- Display all 11 categories from VENDOR_CATEGORIES
- Each category as a card with:
  - Checkbox for "I need this" (adds to categories_needed)
  - Toggle for "Already covered" (adds to categories_covered)
  - Show category icon and description
- Pre-select common categories: venue, catering, photography, musicians, makeup_artist
- Visual feedback: selected categories highlighted, covered categories show checkmark badge
- "Back" and "Next" buttons

**StepReview.tsx:**
- Summary of all entered data
- Show event details in a card
- List needed categories (show which are covered vs pending)
- Calculate: X of Y categories covered
- "Back" and "Create Event" buttons
- Submit button shows loading state during mutation

Reuse StepProgress component from vendor/ProfileWizard (import it, don't duplicate).
  </action>
  <verify>
TypeScript compiles: `cd frontend && npx tsc --noEmit`
  </verify>
  <done>
EventWizard renders 3-step flow with auto-save, category selection shows needed vs covered, submit creates event
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CreateEventPage and add route</name>
  <files>
    frontend/src/pages/CreateEventPage.tsx
    frontend/src/App.js
  </files>
  <action>
**CreateEventPage.tsx:**
- Similar structure to ProfileWizardPage
- Protected route check (must be logged in, but any role - users create events)
- If user is vendor, show info message that this is for planning their own events
- Page layout:
  - Navbar
  - Max-width container (max-w-2xl like ProfileWizard)
  - Page title: "Plan Your Arangetram"
  - Subtitle: "Tell us about your event and we'll help you find the perfect vendors"
  - EventWizard component

**App.js updates:**
- Import CreateEventPage
- Add route: `/events/create` with ProtectedRoute wrapper (no requiredRole, just authenticated)
- Keep existing `/plan` route pointing to PlanEventPage for now (legacy)
  </action>
  <verify>
Navigate to /events/create when logged in - wizard should render
  </verify>
  <done>
CreateEventPage renders wizard, route added to App.js, protected for authenticated users
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. Visit /events/create as logged-in user
2. Fill Step 1 (Details) - name, date required, others optional
3. Navigate to Step 2 - see all 11 categories with checkboxes
4. Select some categories as needed, mark some as covered
5. Navigate to Step 3 - see summary of all data
6. Submit - event created, redirected to dashboard
7. Refresh page mid-wizard - draft data restored from localStorage
</verification>

<success_criteria>
- Event wizard has 3 steps that mirror vendor ProfileWizard structure
- Step 1 validates required fields (name, date) before proceeding
- Step 2 shows all 11 vendor categories with need/covered toggle
- Step 3 shows review with category count
- Auto-save works on every field change
- Submit creates event in database via useCreateEvent
- Route /events/create accessible to authenticated users
</success_criteria>

<output>
After completion, create `.planning/phases/03-event-planning-discovery/03-02-SUMMARY.md`
</output>
